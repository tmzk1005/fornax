tasks.create(name: "releaseTarGz", type: Tar) {
    dependsOn project(":gateway").tasks.getByName("build")
    dependsOn project(":manager").tasks.getByName("build")

    def releaseName = "${rootProject.name}-${rootProject.version}"

    destinationDirectory = project.buildDir
    archiveFileName = "${releaseName}.tgz"
    compression = Compression.GZIP

    into releaseName
    from { 'bin' } { into 'bin/' }
    from { 'conf' } { into 'conf/' }
    from { 
        [
            project(":gateway").configurations.compileClasspath,
            project(":gateway").jar,
            project(":manager").configurations.compileClasspath,
            project(":manager").jar
        ] 
    } { into "libs/" duplicatesStrategy DuplicatesStrategy.EXCLUDE }
}

task clean {
    delete "build"
}
